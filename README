TODO: add_clause should update history too